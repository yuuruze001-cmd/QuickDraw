<?xml version="1.0" encoding="utf-8" ?>
<UserControl
    x:Class="QuickDraw.Views.ImageFolderViewControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:QuickDraw"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:utilities="using:QuickDraw.Utilities"
    x:Name="Control"
    mc:Ignorable="d">
    <Grid x:Name="Root" Padding="0,8,0,8">
        <Grid.Resources>
            <StaticResource x:Key="ButtonBackground" ResourceKey="ControlFillColorTransparentBrush" />
            <StaticResource x:Key="ButtonBorderBrush" ResourceKey="ControlFillColorTransparentBrush" />
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="{Binding Path=DesiredPathColumnWidth, ElementName=Control}" />
            <ColumnDefinition Width="{Binding Path=DesiredImageCountColumnWidth, ElementName=Control}" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <TextBlock
            x:Name="PathText"
            Grid.Column="0"
            Margin="0,0,0,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Center"
            Text="{x:Bind Folder.Path, Mode=OneWay}"
            TextWrapping="Wrap" />

        <ProgressRing
            x:Name="ImageCountLoadingIndicator"
            Grid.Column="1"
            Margin="14,0,0,0"
            VerticalAlignment="Center"
            IsActive="False" />
        <TextBlock
            x:Name="ImageCountText"
            Grid.Column="1"
            Margin="20,0,0,0"
            VerticalAlignment="Center"
            Text="{x:Bind Folder.ImageCount, Mode=OneWay}" />

        <StackPanel Grid.Column="3" Orientation="Horizontal">
            <Button
                x:Name="RefreshButton"
                Margin="10,0,0,0"
                Padding="5,5,5,6"
                Click="Refresh_Click">
                <Viewbox Width="16" Height="16">
                    <SymbolIcon Symbol="Refresh" />
                </Viewbox>
            </Button>
            <Button
                Margin="10,0,0,0"
                Padding="5,5,5,6"
                Click="Folder_Click">
                <Viewbox Width="16" Height="16">
                    <FontIcon Glyph="&#xE838;" />
                </Viewbox>
            </Button>
            <Button
                x:Name="DeleteButton"
                Margin="10,0,0,0"
                Padding="5,5,5,6"
                Click="Delete_Click">
                <Viewbox Width="16" Height="16">
                    <SymbolIcon Symbol="Delete" />
                </Viewbox>
            </Button>
        </StackPanel>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualStateGroup.Transitions>
                    <VisualTransition From="Normal" To="LoadingCount">
                        <VisualTransition.GeneratedEasingFunction>
                            <CubicEase EasingMode="EaseIn" />
                        </VisualTransition.GeneratedEasingFunction>
                    </VisualTransition>
                    <VisualTransition From="LoadingCount" To="Normal">
                        <VisualTransition.GeneratedEasingFunction>
                            <CubicEase EasingMode="EaseIn" />
                        </VisualTransition.GeneratedEasingFunction>
                    </VisualTransition>
                </VisualStateGroup.Transitions>

                <VisualState x:Name="Normal">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind utilities:Binding.InvertBool(Folder.IsLoading), Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="ImageCountLoadingIndicator.IsActive" Value="False" />
                    </VisualState.Setters>
                    <Storyboard>
                        <FadeInThemeAnimation Storyboard.TargetName="ImageCountText" />
                        <FadeOutThemeAnimation Storyboard.TargetName="ImageCountLoadingIndicator" />
                    </Storyboard>
                </VisualState>

                <VisualState x:Name="LoadingCount">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind Folder.IsLoading, Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="RefreshButton.IsEnabled" Value="False" />
                        <Setter Target="DeleteButton.IsEnabled" Value="False" />
                        <Setter Target="ImageCountLoadingIndicator.IsActive" Value="True" />

                    </VisualState.Setters>
                    <Storyboard>
                        <FadeOutThemeAnimation Storyboard.TargetName="ImageCountText" />
                        <FadeInThemeAnimation Storyboard.TargetName="ImageCountLoadingIndicator" />
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</UserControl>
